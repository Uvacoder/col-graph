---
import BaseLayout from '@/layouts/BaseLayout.astro';
import DriversList from '@/components/DriversList.astro';
import PathVisualiser from '@/components/PathVisualiser.astro';

const source = (Astro.url.searchParams.get('source')! || '').trim();
const dest = (Astro.url.searchParams.get('dest')! || '').trim();

// Cache the page for 2 weeks
Astro.response.headers.set('Cache-Control', 'public, max-age=1209600');
---

<BaseLayout>
  <hgroup>
    <h1>Six Degrees of F1</h1>
    <p>Find out which driver is the sport's Kevin Bacon</p>
  </hgroup>
  <p id="prompt">Get all the shortest paths from/to:</p>
  <form action="/" method="GET">
    <fieldset class="grid">
      <input
        type="text"
        name="source"
        value={source}
        placeholder="Source"
        aria-label="Source"
        list="drivers"
        autocomplete="off"
        required
      />
      <input
        type="text"
        name="dest"
        value={dest}
        placeholder="Destination"
        aria-label="Destination"
        list="drivers"
        autocomplete="off"
        required
      />
      <DriversList />
    </fieldset>
    <button type="submit">Submit</button>
  </form>
  {
    source !== '' && dest !== '' && (
      <PathVisualiser source={source} dest={dest} />
    )
  }
</BaseLayout>

<style>
  #prompt {
    margin-top: 1.75rem;
  }

  fieldset.grid {
    margin-bottom: 0.25rem;
  }

  button[type='submit'] {
    margin-bottom: 2rem;
    padding: 0.5rem 0.75rem;
    width: unset;
  }
</style>
